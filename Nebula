getgenv().SecureMode = true
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:FindFirstChildOfClass("Humanoid")
local jumpConnection -- To store the jump connection

-- Function to enable or disable infinite jump
local function enableInfiniteJump(enabled)
    if humanoid then
        if enabled then
            jumpConnection = humanoid:GetPropertyChangedSignal("Jump"):Connect(function()
                humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end)
        else
            if jumpConnection then
                jumpConnection:Disconnect()
            end
        end
    end
end

local Window = Rayfield:CreateWindow({
    Name = "Nebula Hub | @Wenifying#0",
    LoadingTitle = "GUI Loading..",
    LoadingSubtitle = "by Nebula Hardwork",
    ConfigurationSaving = {
       Enabled = true,
       FolderName = nil, -- Customize folder name if needed
       FileName = "Nebula Hub"
    },
    Discord = {
       Enabled = true,
       Invite = "jwSDUCNMZc",
       RememberJoins = true
    },
    KeySystem = true,
    KeySettings = {
       Title = "Nebula Hub | @Wenifying#0",
       Subtitle = "Key System",
       Note = "Join the discord for the key! (.gg/jwSDUCNMZc)",
       FileName = "Key",
       SaveKey = true,
       GrabKeyFromSite = false,
       Key = {"NebulaHub2024"} -- Example key, customize as needed
    }
})

local Tab = Window:CreateTab("Info", 18302197168) -- Title, Image

-- Function to get the player's name
local function getPlayerName()
    local player = game.Players.LocalPlayer
    if player then
       return player.Name
    else
       return "Player" -- Default name if player is not found (usually won't happen in LocalPlayer context)
    end
 end
 
 -- Create a paragraph with dynamic player name in purple color
 local Paragraph = Tab:CreateParagraph({
    Title = "Welcome, " .. getPlayerName() .. "!",
    TitleColor = Color3.fromRGB(175, 25, 255), -- Purple color
    Content = "Welcome to Nebula Hub. The best free universal aimbot script."
 })
 
 -- Update the paragraph title when the player's name changes
 game.Players.LocalPlayer.Changed:Connect(function(property)
    if property == "Name" then
       Paragraph:SetTitle("Welcome, " .. getPlayerName() .. "!")
    end
 end)
 
 local Paragraph = Tab:CreateParagraph({Title = "Version", Content = "V1.0.0 (02/07/24)"})

 local Paragraph = Tab:CreateParagraph({Title = "Join our Discord for support", Content = ".gg/jwSDUCNMZc"})

 local Dropdown = Tab:CreateDropdown({
    Name = "Credits",
    Options = {"Owner - Wenifying & Kyoko","Devs - Hansen","Contributor - Clifford","Porn Addict - Felix"},
    CurrentOption = {"Open to see"},
    MultipleOptions = true,
    Flag = "Dropdown1", -- A flag is the identifier for the configuration file, make sure every element has a different flag if you're using configuration saving to ensure no overlaps
    Callback = function(Option)
    -- The function that takes place when the selected option is changed
    -- The variable (Option) is a table of strings for the current selected options
    end,
 })

local Tab = Window:CreateTab("Main", 4483362458) -- Title, Image
local Section = Tab:CreateSection("Main shits")

local Button = Tab:CreateButton({
    Name = "Aimbot",
    Callback = function()
        g.MouseButton1Click:connect(function()
            local t = game:GetService('Players').LocalPlayer
            local u = workspace.CurrentCamera
            local v = game:GetService('Players')
            local w = v.LocalPlayer
            local x = w:GetMouse()
            local y = t:GetMouse()
            local z = v
            
            function FindNearest(A)
                local B = 1000000
                local C = nil
                for n, r in pairs(v:GetPlayers()) do
                    if r.Character and r.Name ~= t.Name and r.Character:FindFirstChild('UpperTorso') then
                        local D, E = u:WorldToScreenPoint(r.Character.UpperTorso.Position)
                        local F = y.UnitRay:Distance(r.Character.UpperTorso.Position)
                        if F < B and E then
                            B = F
                            C = r
                        end
                    end
                end
                return C
            end
            
            x.Button2Down:Connect(function(G)
                targplr = FindNearest(Vector3.new(y.UnitRay.Origin, y.UnitRay.Direction))
                rightClick = true
            end)
            
            x.Button2Up:Connect(function(G)
                rightClick = false
            end)
            
            _G.LA = game:service'RunService'.Stepped:Connect(function()
                if rightClick and t.Character then
                    if targplr.Character and targplr.Character:FindFirstChild('Head') then
                        u.CFrame = CFrame.new(u.CFrame.Position, targplr.Character.Head.Position)
                    end
                end
            end)
        end)        

local Button = Tab:CreateButton({
    Name = "ESP",
    Callback = function()
        -- ESP Settings
        local FillColor = Color3.fromRGB(175, 25, 255)
        local DepthMode = "AlwaysOnTop"
        local FillTransparency = 0.5
        local OutlineColor = Color3.fromRGB(255, 255, 255)
        local OutlineTransparency = 0

        local CoreGui = game:GetService("CoreGui")
        local Players = game:GetService("Players")
        local lp = Players.LocalPlayer
        local connections = {}

        local Storage = Instance.new("Folder")
        Storage.Parent = CoreGui
        Storage.Name = "Highlight_Storage"

        local function Highlight(plr)
            local Highlight = Instance.new("Highlight")
            Highlight.Name = plr.Name
            Highlight.FillColor = FillColor
            Highlight.DepthMode = DepthMode
            Highlight.FillTransparency = FillTransparency
            Highlight.OutlineColor = OutlineColor
            Highlight.OutlineTransparency = 0
            Highlight.Parent = Storage

            local plrchar = plr.Character
            if plrchar then
                Highlight.Adornee = plrchar
            end

            connections[plr] = plr.CharacterAdded:Connect(function(char)
                Highlight.Adornee = char
            end)
        end

        Players.PlayerAdded:Connect(Highlight)
        for _, v in next, Players:GetPlayers() do
            Highlight(v)
        end

        Players.PlayerRemoving:Connect(function(plr)
            local plrname = plr.Name
            if Storage[plrname] then
                Storage[plrname]:Destroy()
            end
            if connections[plr] then
                connections[plr]:Disconnect()
            end
        end)
    end,
})

local Toggle = Tab:CreateToggle({
    Name = "Always Bright",  -- Updated toggle name
    CurrentValue = false,
    Flag = "AmbientLightToggle",  -- Unique flag for configuration saving
    Callback = function(Value)
        -- Function that runs when the toggle is pressed
        if Value then
            -- Function to adjust ambient lighting based on current time
            local function adjustAmbient()
                local currentTime = game:GetService("Lighting"):GetMinutesAfterMidnight()
                local isDark = currentTime < 300 or currentTime > 1300  -- Define your own dark hours here

                if isDark then
                    game:GetService("Lighting").Ambient = Color3.fromRGB(200, 200, 200)  -- Bright ambient color when it's dark
                    game:GetService("Lighting").OutdoorAmbient = Color3.fromRGB(200, 200, 200)  -- Bright outdoor ambient color when it's dark
                else
                    game:GetService("Lighting").Ambient = Color3.fromRGB(127, 127, 127)  -- Default ambient color during daytime
                    game:GetService("Lighting").OutdoorAmbient = Color3.fromRGB(127, 127, 127)  -- Default outdoor ambient color during daytime
                end
            end

            -- Call the adjustAmbient function periodically
            while Value do
                adjustAmbient()
                wait(10)  -- Adjust the wait time as needed
            end
        else
            -- Handle the case when the toggle is turned off, if needed
            -- For ambient lighting, you might want to reset to a default state or turn off the periodic adjustment
        end
    end,
})

-- Add the button for Nebula Flying GUI
local Button = Tab:CreateButton({
    Name = "Nebula Flying GUI",
    Callback = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/Wenifying/Beta/main/NebulaFlyingGUI'))()
    end,
})

local Tab = Window:CreateTab("Fun Stuff", 4483362458) -- Title, Image
local Section = Tab:CreateSection("Fun shits")

local Toggle = Tab:CreateToggle({
    Name = "Infinite Jump",
    CurrentValue = false,
    Flag = "Toggle_InfiniteJump", -- Unique identifier for the configuration file
    Callback = function(Value)
        enableInfiniteJump(Value)
    end,
})

-- Check if humanoid exists before proceeding
if humanoid then
    -- Adjusting Jump Height Slider
    local JumpHeightSlider = Tab:CreateSlider({
        Name = "JumpHeight",
        Range = {0, 1000},  -- Adjusted to range from 0 to 1000
        Increment = 50,     -- Adjusted increment for smoother adjustments
        Suffix = "Jump Height",
        CurrentValue = 50,  -- Set to a standard jump height value
        Flag = "Slider_JumpHeight", -- Unique identifier for the configuration file
        Callback = function(Value)
            humanoid.JumpPower = Value
        end,
    })

    -- Adjusting Speed Slider
    local SpeedSlider = Tab:CreateSlider({
        Name = "Speed",
        Range = {0, 100},
        Increment = 10,
        Suffix = "Speed",
        CurrentValue = 16,  -- Set to a standard walking speed value
        Flag = "Slider_Speed", -- Unique identifier for the configuration file
        Callback = function(Value)
            humanoid.WalkSpeed = Value
        end,
    })

    -- Initialize with default values
    humanoid.JumpPower = JumpHeightSlider.CurrentValue
    humanoid.WalkSpeed = SpeedSlider.CurrentValue
end

-- Initialize infinite jump if toggle is initially enabled
enableInfiniteJump(Toggle.CurrentValue)

-- Listen for player character changes
player.CharacterAdded:Connect(function(newCharacter)
    character = newCharacter
    humanoid = character:FindFirstChildOfClass("Humanoid")
    enableInfiniteJump(Toggle.CurrentValue)
end)

-- Listen for toggle state changes through key press (optional)
UIS.InputBegan:Connect(function(input, processed)
    if not processed and input.KeyCode == Enum.KeyCode.X then
        Toggle:SetValue(not Toggle.CurrentValue)
    end
end)



 Rayfield:Destroy()
Rayfield:LoadConfiguration()
